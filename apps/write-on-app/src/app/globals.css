@import "tailwindcss";

:root {
  --background: #ffffff;
  --foreground: #171717;
}

@theme inline {
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --font-sans: var(--font-geist-sans);
  --font-mono: var(--font-geist-mono);
}

@media (prefers-color-scheme: dark) {
  :root {
    --background: #0a0a0a;
    --foreground: #ededed;
  }
}

/* Reset default margins and ensure full-height root for layout stability */
html, body {
  margin: 0;
  padding: 0;
  height: 100%;
}

body {
  background: var(--background);
  color: var(--foreground);
  font-family: Arial, Helvetica, sans-serif;
}

/* Next.js root height safety */
#__next, body > div:first-child {
  min-height: 100%;
}

/* Prevent scroll chaining during zoom handling */
.main-scroll {
  overscroll-behavior: none;
}

/* Input guardrails */
.workspace-root, .workspace-canvas-mount, canvas {
  user-select: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  touch-action: none;
}

/* Phase-2: pin control strip and offset content */
.control-strip {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  width: 100%;
  z-index: 1000;
  display: flex;
  flex-direction: column;
  /* Provide a solid surface behind chrome to prevent content bleed-through */
  background-color: var(--chrome-bg, #ffffff);
  /* Optional subtle bottom border for separation */
  border-bottom: 1px solid var(--border-subtle, #e5e7eb);
}

/* Respect device safe areas on the top header area so measurements include the inset */
.chrome-header {
  padding-top: constant(safe-area-inset-top); /* iOS 11.2 legacy */
  padding-top: env(safe-area-inset-top);
  padding-left: env(safe-area-inset-left);
  padding-right: env(safe-area-inset-right);
}

/* Top offset is applied in WorkspaceViewport using --h-stack;
   avoid duplicating here to prevent double spacing. */
.workspace-root {
  /* The viewport height varies on mobile browsers; prefer dynamic dvh with vh fallback */
  height: 100vh;
  height: 100dvh;
  padding-top: 0;
}

.workspace-scaler {
  transform-origin: 0 0;
  will-change: transform;
}

/* Debug layout outlines (temporary aid) */
.debug-layout .workspace-viewport {
  outline: 1px solid #3b82f6; /* blue */
}
.debug-layout .workspace-scaler {
  outline: 1px solid #22c55e; /* green */
}
.debug-layout .workspace-canvas-mount {
  outline: 1px solid #fb923c; /* orange */
}

/* Workspace root composite vars: CSS owns computed heights */
[data-workspace-root] {
  /* default gaps and indicator height */
  --gap-header-top: 8px;
  --gap-top-opts: 8px;
  --gap-indicator-above: 8px;
  --gap-indicator-below: 12px;
  --h-indicator: 40px;
  /* computed stacks */
  --h-chrome: calc(var(--h-header) + var(--h-top) + var(--h-opts));
  --h-stack: calc(
    var(--h-chrome)
    + var(--gap-header-top)
    + var(--gap-top-opts)
    + var(--gap-indicator-above)
    + var(--h-indicator)
    + var(--gap-indicator-below)
  );
}
